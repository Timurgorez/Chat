(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{116:function(e,t,a){},117:function(e,t,a){},165:function(e,t,a){},171:function(e,t,a){},172:function(e,t,a){"use strict";a.r(t);var n=a(0),c=a.n(n),s=a(10),r=a.n(s),o=a(40),i=a(29),l=a(28),u=a(99),j=a(14),O="apiData/SET_CHAT",d="apiData/SET_MESSAGES",m="apiData/SET_USERS",b="apiData/SET_IS_AUTH",p="apiData/ADD_MESSAGE",h={chat:{},users:[],messages:[],name:"",roomId:null,isAuth:!1};var f="appHelper/SHOW_LOADER",x="appHelper/HIDE_LOADER",g="appHelper/SHOW_ALERT",v="appHelper/HIDE_ALERT",E={loading:!1,alert:null};var N=Object(o.b)({api:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:h,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case O:return Object(j.a)(Object(j.a)({},e),{},{chat:t.payload});case m:return Object(j.a)(Object(j.a)({},e),{},{users:t.payload});case d:return Object(j.a)(Object(j.a)({},e),{},{messages:t.payload});case p:return Object(j.a)(Object(j.a)({},e),{},{messages:[].concat(Object(u.a)(e.messages),[t.payload])});case b:return Object(j.a)(Object(j.a)({},e),{},{isAuth:t.payload});default:return e}},helper:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:E,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case f:return Object(j.a)(Object(j.a)({},e),{},{loading:!0});case x:return Object(j.a)(Object(j.a)({},e),{},{loading:!1});case g:return Object(j.a)(Object(j.a)({},e),{},{alert:t.payload});case v:return Object(j.a)(Object(j.a)({},e),{},{alert:null});default:return e}}}),S=(a(116),a(97)),_=a(9),y=(a(117),a(59)),I=a.n(y),D=a(90),R=a(46),T=a(200),w=a(204),A=a(208),M=a(205),U=a(206),W=a(91),C=a.n(W),H=a(92),L=a.n(H)()();L.connect();var k=L,G=(a(165),a(4));var V=function(){var e=Object(_.f)(),t=Object(i.b)(),a=Object(n.useState)(""),s=Object(R.a)(a,2),r=s[0],o=s[1],u=Object(n.useState)(""),j=Object(R.a)(u,2),O=j[0],d=j[1],m=function(){var a=Object(D.a)(I.a.mark((function a(n){return I.a.wrap((function(a){for(;;)switch(a.prev=a.next){case 0:if(n.preventDefault(),!O.trim()||!r.trim()){a.next=10;break}return a.next=4,C.a.post("/rooms",{userName:r,roomId:O}).then((function(e){console.log("POST",e.data)}));case 4:d(""),o(""),t({type:b,payload:!0}),e.push("/room/"+O+"/"+r),k.emit("ROOM:JOIN",{roomId:O,userName:r}),l.b.success("Welcome in room!");case 10:case"end":return a.stop()}}),a)})));return function(e){return a.apply(this,arguments)}}();return Object(G.jsx)(c.a.Fragment,{children:Object(G.jsxs)(T.a,{maxWidth:"xl",className:"live-chat__container",children:[Object(G.jsx)("h1",{children:"Create privat chat"}),Object(G.jsx)(w.a,{container:!0,spacing:3,children:Object(G.jsx)(w.a,{item:!0,xs:6,children:Object(G.jsx)("form",{className:"form",noValidate:!0,autoComplete:"off",onSubmit:m,children:Object(G.jsxs)("div",{children:[Object(G.jsxs)(A.a,{fullWidth:!0,className:"input-wrapper",variant:"outlined",children:[Object(G.jsx)(M.a,{className:"name-input",id:"name-input",label:"Your name",value:r,name:"userName",onChange:function(e){return o(e.target.value)},variant:"outlined"}),Object(G.jsx)(M.a,{className:"room-input",id:"room-input",label:"Room name",name:"roomId",value:O,onChange:function(e){return d(e.target.value)},variant:"outlined"})]}),Object(G.jsx)(U.a,{type:"submit",variant:"contained",color:"secondary",children:"Go to room"})]})})})})]})})},F=(a(171),a(98));var J=function(){var e=Object(i.b)(),t=Object(_.f)(),a=Object(_.g)(),c=a.roomId,s=a.userName,r=Object.values(Object(i.c)((function(e){return e.api.users}))),o=Object(i.c)((function(e){return e.api.isAuth})),u=Object(i.c)((function(e){return e.api.messages}));console.log("USERS",r);var j=Object(n.useState)(""),O=Object(R.a)(j,2),b=O[0],h=O[1];Object(n.useEffect)((function(){console.log("isAuth",o),o||t.push("/"),k.emit("ROOM:INIT_RUN",c),k.on("ROOM:INIT_GET",(function(e){console.log(e),x(e.users),g(e.messages)})),k.on("ROOM:JOINED",(function(e){console.log("NEW USER",e),l.b.success("New user ("+e.newUser+") is connected!"),x(e.users)})),k.on("ROOM:NEW_MESSAGE",(function(e){console.log("NEW_MESSAGE",e),l.b.success("New message from ("+e.userName+") !"),f(e),document.querySelector("#msgField").scrollTo({top:99999,behavior:"smooth"})})),k.on("ROOM:LEAVE",(function(e){console.log("LEAVE USER",e),l.b.success("User ("+e.leaveUser+") is disconnected!"),x(e.users)}))}),[]);var f=function(t){e({type:p,payload:t})},x=function(t){e({type:m,payload:t})},g=function(t){e({type:d,payload:t})};return Object(G.jsxs)("div",{className:"live-chat",children:[Object(G.jsx)("h1",{children:"Private Chat"}),Object(G.jsx)(T.a,{maxWidth:"md",className:"live-chat__container",children:Object(G.jsxs)(w.a,{container:!0,spacing:3,className:"wrap-block",children:[Object(G.jsxs)(w.a,{item:!0,xs:4,className:"users-block",children:[Object(G.jsxs)("h3",{children:["Online ",r&&r.length," users"]}),r&&r.map((function(e){return Object(G.jsx)("p",{children:e},e)}))]}),Object(G.jsxs)(w.a,{item:!0,xs:8,className:"messages-block",children:[Object(G.jsx)("h3",{children:"Chat Area"}),Object(G.jsx)("div",{id:"msgField",children:u.map((function(e,t){return Object(G.jsxs)(F.a,{className:"chat-msg",elevation:3,style:{background:"lightgrey",marginLeft:e.userName===s&&"40px",marginRight:e.userName===s&&"0"},children:[Object(G.jsx)("span",{children:e.userName}),Object(G.jsx)("p",{children:e.text}),Object(G.jsx)("span",{className:"chat-timestamp",children:new Date(e.date).toISOString()})]},t)}))}),Object(G.jsx)("hr",{}),Object(G.jsx)("form",{className:"form",noValidate:!0,autoComplete:"off",onSubmit:function(e){if(e.preventDefault(),b){var t={userName:s,roomId:c,text:b,date:(new Date).toString()};f(t),setTimeout((function(){document.querySelector("#msgField").scrollTo({top:99999,behavior:"smooth"})}),100),k.emit("ROOM:NEW_MESSAGE",t),h("")}},children:Object(G.jsxs)("div",{children:[Object(G.jsx)(A.a,{fullWidth:!0,className:"input-wrapper",variant:"outlined",children:Object(G.jsx)(M.a,{className:"msg-input",id:"outlined-multiline-static",label:"Type here!",multiline:!0,rows:1,value:b,onChange:function(e){return h(e.target.value)},variant:"outlined"})}),Object(G.jsx)(U.a,{type:"submit",variant:"contained",color:"secondary",children:"Send"})]})})]})]})})]})};var X=function(){return Object(G.jsx)(S.a,{children:Object(G.jsx)("div",{className:"app",children:Object(G.jsxs)(_.c,{children:[Object(G.jsx)(_.a,{exact:!0,path:"/",component:V}),Object(G.jsx)(_.a,{path:"/room/:roomId/:userName",exact:!0,component:J})]})})})},q=Object(o.d)(N,Object(o.c)(Object(o.a)(),window.__REDUX_DEVTOOLS_EXTENSION__&&window.__REDUX_DEVTOOLS_EXTENSION__()));r.a.render(Object(G.jsxs)(i.a,{store:q,children:[Object(G.jsx)(l.a,{position:"top-right",toastOptions:{style:{paddingLeft:"15px",zIndex:1},iconClose:{primary:"grey"},duration:3e3}}),Object(G.jsx)(X,{})]}),document.getElementById("root"))}},[[172,1,2]]]);
//# sourceMappingURL=main.d8f0398d.chunk.js.map